@{
    ViewBag.Title = "eForms";
}
@*<br />
<ol class="breadcrumb">@ViewBag.Title</ol>
<div class="row"></div>*@
<br />
<div class="container-fluid">
    <table border="0" cellpadding="0" cellspacing="0" class="table table-striped table-bordered table-condensed table-hover dataTable no-footer" id="check_lists" width="100%" role="grid" aria-describedby="check_lists_info" style="width: 100%;">
        <thead>
            <tr role="row">
                <th class="col-md-1 text-center" rowspan="1" colspan="1">
                    #
                </th>
                <th class="col-md-2 text-center" rowspan="1" colspan="1">
                    Created at
                </th>
                <th class="col-md-2 text-center" rowspan="1" colspan="1">
                    Updated at
                </th>
                <th class="col-md-3 text-center" rowspan="1" colspan="1">
                    Label
                </th>
                <th class="col-md-2 text-center" rowspan="1" colspan="1">
                    Deployed to
                </th>
                <th class="col-md-1 text-center" rowspan="1" colspan="1">
                    Actions
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (eFormFrontendDotNet.Models.check_lists item in @ViewBag.check_lists)
            {
                bool deployed = false;
                <tr>
                    <td class="text-center">
                        @item.id
                    </td>
                    <td class="text-center">
                        @item.created_at
                    </td>
                    <td class="text-center">
                        @item.updated_at
                    </td>
                    <td class="text-center">
                        @item.label
                    </td>
                    <td class="text-center">
                        @foreach (eFormFrontendDotNet.Models.cases deplyed_case in item.cases.ToList())
                        {
                            <span>
                                @if (deplyed_case.site != null)
                                {
                                    @deplyed_case.site.name
                                    if (deplyed_case.workflow_state == "created")
                                    {
                                        deployed = true;
                                    }
                                }
                                else
                                {
                                    foreach (eFormFrontendDotNet.Models.check_list_sites check_list_site in item.check_list_sites.ToList())
                                    {
                                        @check_list_site.site.name
                                        if (check_list_site.workflow_state == "created")
                                        {
                                            deployed = true;
                                        }
                                    }
                                }
                            </span>
                        }
                    </td>
                    <td class="text-center">
                        @if (item.cases.Count > 0)
                        {
                            <a href="/Case/Index/@(item.id)" class="needs_tooltip btn btn-ar btn-sm btn-default mt-edit-check-list-button" data-placement="top" data-toggle="tooltip" id="edit_check_list_@(item.id)" title="" type="button" data-original-title="Show cases">
                                <span class="glyphicon glyphicon-search" data-mt-check-list-id="@(item.id)"></span>
                            </a>
                            <a href="/Template/Csv/@(item.id)" class="needs_tooltip btn btn-ar btn-sm btn-success" data-placement="top" data-toggle="tooltip" id="csv_check_list_@(item.id)" title="" type="button" data-original-title="Download CSV">
                                <span class="fa fa-file-text-o"></span>
                            </a>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
